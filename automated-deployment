#Golang CLI Binary: https://github.com/kf5i/k3ai-core/releases
#Manage custom Add-Ons
Expand-Archive -Path .\k3ai.zip
.\k3ai.exe -h

#Install Kustomize in WSL
curl -s "https://raw.githubusercontent.com/kubernetes-sigs/kustomize/master/hack/install_kustomize.sh"  | bash

#Install Kubeflow Linux
#while ! ../../kustomize build example | kubectl apply -f -;
#do echo "Retrying to apply resources"; sleep 10; done

#Install Kubeflow Windows
SET PIPELINE_VERSION=1.7.0
kubectl apply -k "github.com/kubeflow/pipelines/manifests/kustomize/cluster-scoped-resources?ref=$PIPELINE_VERSION"
kubectl wait --for condition=established --timeout=60s crd/applications.app.k8s.io
kubectl apply -k "github.com/kubeflow/pipelines/manifests/kustomize/env/platform-agnostic-pns?ref=$PIPELINE_VERSION"

kubectl port-forward -n kubeflow svc/ml-pipeline-ui 8080:80

#Cleanup
export PIPELINE_VERSION=1.7.0
kubectl delete -k "github.com/kubeflow/pipelines/manifests/kustomize/env/platform-agnostic-pns?ref=$PIPELINE_VERSION"
kubectl delete -k "github.com/kubeflow/pipelines/manifests/kustomize/cluster-scoped-resources?ref=$PIPELINE_VERSION"

#Helm Chart:
helm install kubernetes-data-science kubernetes-data-science.tgz --set service.type=NodePort
